<link rel="import" href="../bower_components/polymer/polymer.html">

<dom-module id="bihi-editor">
  <style>
    :host {
      display: flex;
      width: 100%;
    };
  </style>

  <template>
    <content></content>
  </template>

</dom-module>

<script>
  Polymer({
    is: "bihi-editor",
    listeners: {
      "parameter-change": "rendererRefresh",
      "viz-change": "updateViz",
      "editor-state-change": "stateChange",
    },
    ready: function() {
      this.state = new EditorState();
    },
    reset: function() {
      /* TODO: make sure the markup is set correctly here:
        - empty description
        - reset the accordion
        - 
       */
      this.state.setState(EditorState.NEW);
    },
    init: function(initValues) {
      var rendererEl = Polymer.dom(this).node.querySelector("bihi-renderer3d");
      rendererEl.init(initValues);
      if (initValues.id) {
        this.state.setState(EditorState.SAVED);
      } else {
        this.state.setState(EditorState.READY);
      }
    },
    rendererRefresh: function() {
      var rendererEl = Polymer.dom(this).node.querySelector("bihi-renderer3d");
      this.fire("refresh", {}, rendererEl, false);
    },
    stateChange: function (e) {
      var rendererEl = Polymer.dom(this).node.querySelector("bihi-renderer3d");
      this.fire("state-change", {state: e.detail.state}, rendererEl, false);
    },
    updateViz: function(e) {
      var rendererEl = Polymer.dom(this).node.querySelector("bihi-renderer3d");
      this.fire("update-viz", e.detail, rendererEl, false);
    },
    properties: {
      state: {
        type: Object
      }
    }
  });
</script>
